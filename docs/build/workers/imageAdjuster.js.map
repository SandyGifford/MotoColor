{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/prod/utils/ColorUtils.ts","webpack:///./src/prod/utils/ImageUtils.ts","webpack:///./src/prod/utils/NumberUtils.ts","webpack:///./src/prod/workers/imageAdjuster.worker.ts"],"names":[],"mappings":"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","file":"workers/imageAdjuster.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/prod/workers/imageAdjuster.worker.ts\");\n","// based on https://gist.github.com/mjackson/5311256\n\nimport { HSLColor, ArrayColor } from \"@typings/color\";\n\nexport default class ColorUtils {\n\tpublic static getCSSColor(color: HSLColor): string {\n\t\tconst { h, s, l, a } = color;\n\t\treturn `hsla(${360 * h / 255}, ${100 * s / 255}%, ${100 * l / 255}%, ${a / 255})`;\n\t}\n\n\t/**\n\t * Converts an RGB color value to HSL. Conversion formula\n\t * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n\t * Assumes r, g, and b are contained in the set [0, 255] and\n\t * returns h, s, and l in the set [0, 1].\n\t *\n\t * @param   Number  r       The red color value\n\t * @param   Number  g       The green color value\n\t * @param   Number  b       The blue color value\n\t * @return  Array           The HSL representation\n\t */\n\tpublic static rgbToHSL(color: ArrayColor): ArrayColor {\n\t\tlet [r, g, b, a] = color;\n\n\t\tr /= 255, g /= 255, b /= 255;\n\n\t\tconst max = Math.max(r, g, b), min = Math.min(r, g, b);\n\t\tlet h, s, l = (max + min) / 2;\n\n\t\tif (max === min) {\n\t\t\th = s = 0; // achromatic\n\t\t} else {\n\t\t\tconst d = max - min;\n\t\t\ts = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n\n\t\t\tswitch (max) {\n\t\t\t\tcase r: h = (g - b) / d + (g < b ? 6 : 0); break;\n\t\t\t\tcase g: h = (b - r) / d + 2; break;\n\t\t\t\tcase b: h = (r - g) / d + 4; break;\n\t\t\t}\n\n\t\t\th /= 6;\n\t\t}\n\n\t\treturn [h * 255, s * 255, l * 255, a];\n\t}\n\n\t/**\n\t * Converts an HSL color value to RGB. Conversion formula\n\t * adapted from http://en.wikipedia.org/wiki/HSL_color_space.\n\t * Assumes h, s, and l are contained in the set [0, 1] and\n\t * returns r, g, and b in the set [0, 255].\n\t *\n\t * @param   Number  h       The hue\n\t * @param   Number  s       The saturation\n\t * @param   Number  l       The lightness\n\t * @return  Array           The RGB representation\n\t */\n\tpublic static hslToRGB(color: ArrayColor): ArrayColor {\n\t\tlet [h, s, l, a] = color;\n\t\th /= 255;\n\t\ts /= 255;\n\t\tl /= 255;\n\t\tlet r, g, b;\n\n\t\tif (s === 0) {\n\t\t\tr = g = b = l; // achromatic\n\t\t} else {\n\n\t\t\tconst q = l < 0.5 ? l * (1 + s) : l + s - l * s;\n\t\t\tconst p = 2 * l - q;\n\n\t\t\tr = ColorUtils.hue2RGBComponent(p, q, h + 1 / 3);\n\t\t\tg = ColorUtils.hue2RGBComponent(p, q, h);\n\t\t\tb = ColorUtils.hue2RGBComponent(p, q, h - 1 / 3);\n\t\t}\n\n\t\treturn [r * 255, g * 255, b * 255, a];\n\t}\n\n\tprivate static hue2RGBComponent(p: number, q: number, t: number): number {\n\t\tif (t < 0) t += 1;\n\t\tif (t > 1) t -= 1;\n\t\tif (t < 1 / 6) return p + (q - p) * 6 * t;\n\t\tif (t < 1 / 2) return q;\n\t\tif (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6;\n\t\treturn p;\n\t}\n}","import { ArrayColor } from \"@typings/color\";\nimport ColorUtils from \"./ColorUtils\";\n\n\nexport interface ArrayPixelData {\n\twidth: number;\n\theight: number;\n\tpixels: Uint8ClampedArray;\n}\n\nexport type PixelLoopAction<T> = (pixel: ArrayColor, pixelIndex: number, componentIndex: number) => T;\nexport type ForEachPixelAction = PixelLoopAction<void>;\nexport type MapPixelAction<T> = PixelLoopAction<T>;\n\nexport default class ImageUtils {\n\tpublic static forEachPixel(pixels: Uint8ClampedArray, act: ForEachPixelAction): void {\n\t\tfor (let i = 0; i < pixels.length; i += 4) act(\n\t\t\t[\n\t\t\t\tpixels[i],\n\t\t\t\tpixels[i + 1],\n\t\t\t\tpixels[i + 2],\n\t\t\t\tpixels[i + 3]\n\t\t\t],\n\t\t\ti / 4,\n\t\t\ti,\n\t\t);\n\t}\n\n\tpublic static mapPixels<T>(pixels: Uint8ClampedArray, act: MapPixelAction<T>): T[] {\n\t\tconst arr: T[] = [];\n\t\tImageUtils.forEachPixel(pixels, (pixel, pixelIndex, componentIndex) => arr.push(act(pixel, pixelIndex, componentIndex)));\n\t\treturn arr;\n\t}\n\n\tpublic static mapPixelsToPixels(pixels: Uint8ClampedArray, act: MapPixelAction<ArrayColor>): Uint8ClampedArray {\n\t\tconst arr = new Uint8ClampedArray(pixels.length);\n\t\tImageUtils.forEachPixel(pixels, (pixel, pI, cI) => {\n\t\t\tconst newPixel = act(pixel, pI, cI)\n\t\t\tarr[cI] = newPixel[0];\n\t\t\tarr[cI + 1] = newPixel[1];\n\t\t\tarr[cI + 2] = newPixel[2];\n\t\t\tarr[cI + 3] = newPixel[3];\n\t\t});\n\t\treturn arr;\n\t}\n\n\tpublic static loadImage(url: string): Promise<HTMLImageElement> {\n\t\treturn new Promise((res, rej) => {\n\t\t\tconst img = document.createElement(\"img\");\n\t\t\timg.addEventListener(\"load\", () => res(img));\n\t\t\timg.addEventListener(\"error\", rej);\n\t\t\timg.src = url;\n\t\t});\n\t}\n\n\tpublic static loadImageIntoCanvas(url: string): Promise<HTMLCanvasElement> {\n\t\treturn ImageUtils.loadImage(url)\n\t\t\t.then(img => {\n\t\t\t\tconst cvs = document.createElement(\"canvas\");\n\t\t\t\tconst ctx = cvs.getContext(\"2d\");\n\n\t\t\t\tcvs.width = img.width;\n\t\t\t\tcvs.height = img.height;\n\n\t\t\t\tctx.drawImage(img, 0, 0);\n\n\t\t\t\treturn cvs;\n\t\t\t});\n\t}\n\n\tpublic static loadImageIntoRGBPixelData(url: string): Promise<ArrayPixelData> {\n\t\treturn ImageUtils.loadImageIntoCanvas(url)\n\t\t\t.then(cvs => {\n\t\t\t\tconst { width, height } = cvs;\n\t\t\t\tconst ctx = cvs.getContext(\"2d\");\n\t\t\t\tconst imageData = ctx.getImageData(0, 0, width, height);\n\t\t\t\tconst { data } = imageData;\n\n\t\t\t\tconst pixels = new Uint8ClampedArray(data);\n\n\t\t\t\treturn {\n\t\t\t\t\tpixels,\n\t\t\t\t\twidth,\n\t\t\t\t\theight,\n\t\t\t\t};\n\t\t\t});\n\t}\n\n\tpublic static loadImageIntoHSLPixelData(url: string): Promise<ArrayPixelData> {\n\t\treturn ImageUtils.loadImageIntoRGBPixelData(url)\n\t\t\t.then(pixelData => ({\n\t\t\t\twidth: pixelData.width,\n\t\t\t\theight: pixelData.height,\n\t\t\t\tpixels: ImageUtils.mapPixelsToPixels(pixelData.pixels, ColorUtils.rgbToHSL),\n\t\t\t}));\n\t}\n}","export default class NumberUtils {\n\tpublic static clamp(val: number, min: number, max: number): number {\n\t\treturn Math.max(min, Math.min(max, val));\n\t}\n}","import NumberUtils from \"@utils/NumberUtils\";\nimport { SetBasePixelsMessage, AdjustImageMessage, AdjustImageMessageData, PixelsAdjustedMessage } from \"./messages\";\nimport ImageUtils from \"@utils/ImageUtils\";\n\ntype IncomingMessage = SetBasePixelsMessage | AdjustImageMessage;\n\nlet basePixels: Uint8ClampedArray;\n\nonmessage = e => {\n\tconst { type, id, data } = (e.data as IncomingMessage);\n\n\tswitch (type) {\n\t\tcase \"setBasePixels\":\n\t\t\tbasePixels = data as Uint8ClampedArray;\n\n\t\t\tpostMessage({\n\t\t\t\tid,\n\t\t\t\ttype: \"basePixelsUpdated\",\n\t\t\t\tdata: true,\n\t\t\t}, undefined);\n\t\t\tbreak;\n\t\tcase \"adjustImage\":\n\t\t\tconst { adjustment, transferBuffer } = (data as AdjustImageMessageData);\n\t\t\tconst uint8 = new Uint8ClampedArray(transferBuffer);\n\n\t\t\tconst s = adjustment[1] / 128;\n\t\t\tconst l = adjustment[2] / 128;\n\n\t\t\tImageUtils.forEachPixel(basePixels, (pixel, pI, cI) => {\n\t\t\t\tuint8[cI] = adjustment[0];\n\t\t\t\tuint8[cI + 1] = NumberUtils.clamp(pixel[1] * s, 0, 255);\n\t\t\t\tuint8[cI + 2] = NumberUtils.clamp(pixel[2] * l, 0, 255);\n\t\t\t\tuint8[cI + 3] = pixel[3];\n\t\t\t});\n\n\t\t\tconst message: PixelsAdjustedMessage = {\n\t\t\t\tid,\n\t\t\t\ttype: \"pixelsAdjusted\",\n\t\t\t\tdata: uint8.buffer,\n\t\t\t};\n\n\t\t\tpostMessage(message, undefined, [uint8.buffer]);\n\t\t\tbreak;\n\t}\n};\n"],"sourceRoot":""}